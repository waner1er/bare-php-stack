{"version":3,"file":"admin.js","sources":["../../../src/Interface/Admin/Assets/js/pages/menu.js","../../../src/Interface/Admin/Assets/js/admin.js"],"sourcesContent":["/**\n * Menu Management Page\n * Handles form validation, slug checking, and dynamic form filling\n */\n\n// Slugs réservés pour les pages système\nconst RESERVED_SLUGS = [\n  \"contact\",\n  \"archive\",\n  \"login\",\n  \"register\",\n  \"logout\",\n  \"posts\",\n  \"admin\",\n];\n\n// Slugs déjà utilisés dans le menu (injecté depuis le serveur)\nlet usedMenuSlugs = [];\n\n/**\n * Initialize menu page functionality\n */\nexport function initMenuPage() {\n  // Check if we're on the menu page\n  const menuForm = document.getElementById(\"menuForm\");\n  if (!menuForm) return;\n\n  // Get used slugs from data attribute\n  const slugsData = menuForm.dataset.usedSlugs;\n  if (slugsData) {\n    usedMenuSlugs = JSON.parse(slugsData);\n  }\n\n  // Setup event listeners\n  setupEventListeners();\n}\n\n/**\n * Setup all event listeners for the menu page\n */\nfunction setupEventListeners() {\n  const slugInput = document.getElementById(\"slug\");\n  const typeInput = document.getElementById(\"type\");\n  const menuForm = document.getElementById(\"menuForm\");\n\n  if (slugInput) {\n    slugInput.addEventListener(\"input\", validateSlug);\n  }\n\n  if (typeInput) {\n    typeInput.addEventListener(\"change\", validateSlug);\n  }\n\n  if (menuForm) {\n    menuForm.addEventListener(\"submit\", handleFormSubmit);\n  }\n}\n\n/**\n * Fill form with provided values\n * @param {string} label - The label for the menu item\n * @param {string} slug - The slug for the menu item\n * @param {string} type - The type of menu item (post/archive)\n */\nexport function fillForm(label, slug, type) {\n  const labelInput = document.getElementById(\"label\");\n  const slugInput = document.getElementById(\"slug\");\n  const typeInput = document.getElementById(\"type\");\n\n  if (labelInput) labelInput.value = label;\n  if (slugInput) slugInput.value = slug;\n  if (typeInput) typeInput.value = type;\n\n  validateSlug();\n}\n\n/**\n * Validate the slug field\n */\nfunction validateSlug() {\n  const slugInput = document.getElementById(\"slug\");\n  const typeInput = document.getElementById(\"type\");\n  const errorEl = document.getElementById(\"slug-error\");\n  const warningEl = document.getElementById(\"slug-warning\");\n  const submitBtn = document.getElementById(\"submitBtn\");\n\n  if (!slugInput || !typeInput || !errorEl || !warningEl || !submitBtn) return;\n\n  const slug = slugInput.value.trim();\n  const type = typeInput.value;\n\n  // Reset states\n  errorEl.style.display = \"none\";\n  warningEl.style.display = \"none\";\n  submitBtn.disabled = false;\n\n  if (!slug) return;\n\n  // Check if slug is already in menu\n  if (usedMenuSlugs.includes(slug)) {\n    errorEl.textContent = \"⚠️ Ce slug est déjà dans le menu\";\n    errorEl.style.display = \"block\";\n    submitBtn.disabled = true;\n    return;\n  }\n\n  // Check if slug is reserved (except for post types)\n  if (type !== \"post\" && RESERVED_SLUGS.includes(slug)) {\n    errorEl.textContent = \"⚠️ Ce slug est réservé pour une page système\";\n    errorEl.style.display = \"block\";\n    submitBtn.disabled = true;\n    return;\n  }\n\n  // Warning if reserved slug but post type\n  if (type === \"post\" && RESERVED_SLUGS.includes(slug)) {\n    warningEl.textContent =\n      \"⚠️ Attention : ce slug correspond à une page système, il y aura un conflit\";\n    warningEl.style.display = \"block\";\n  }\n}\n\n/**\n * Handle form submission\n * @param {Event} e - The submit event\n */\nfunction handleFormSubmit(e) {\n  const slugInput = document.getElementById(\"slug\");\n  if (!slugInput) return;\n\n  const slug = slugInput.value.trim();\n\n  if (usedMenuSlugs.includes(slug)) {\n    e.preventDefault();\n    alert(\"Ce slug est déjà dans le menu\");\n    return false;\n  }\n}\n\n/**\n * Toggle category select based on type\n */\nexport function toggleCategorySelect() {\n  const type = document.getElementById(\"type\");\n  const categoryGroup = document.getElementById(\"categoryGroup\");\n  const postsSection = document.getElementById(\"postsSection\");\n  const categoriesSection = document.getElementById(\"categoriesSection\");\n  const categoryIdInput = document.getElementById(\"category_id\");\n\n  if (!type) return;\n\n  if (type.value === \"archive\") {\n    if (categoryGroup) categoryGroup.style.display = \"block\";\n    if (postsSection) postsSection.style.display = \"none\";\n    if (categoriesSection) categoriesSection.style.display = \"block\";\n  } else {\n    if (categoryGroup) categoryGroup.style.display = \"none\";\n    if (postsSection) postsSection.style.display = \"block\";\n    if (categoriesSection) categoriesSection.style.display = \"none\";\n    if (categoryIdInput) categoryIdInput.value = \"\";\n  }\n}\n\n/**\n * Fill form for all posts archive\n */\nexport function fillFormForAllPosts() {\n  const labelInput = document.getElementById(\"label\");\n  const slugInput = document.getElementById(\"slug\");\n  const typeInput = document.getElementById(\"type\");\n  const categoryIdInput = document.getElementById(\"category_id\");\n\n  if (labelInput) labelInput.value = \"Tous les articles\";\n  if (slugInput) slugInput.value = \"posts\";\n  if (typeInput) typeInput.value = \"archive\";\n  if (categoryIdInput) categoryIdInput.value = \"\";\n\n  toggleCategorySelect();\n  validateSlug();\n}\n\n/**\n * Fill form for specific category\n * @param {string} name - Category name\n * @param {string} slug - Category slug\n * @param {number} categoryId - Category ID\n */\nexport function fillFormForCategory(name, slug, categoryId) {\n  const labelInput = document.getElementById(\"label\");\n  const slugInput = document.getElementById(\"slug\");\n  const typeInput = document.getElementById(\"type\");\n  const categoryIdInput = document.getElementById(\"category_id\");\n\n  if (labelInput) labelInput.value = name;\n  if (slugInput) slugInput.value = slug;\n  if (typeInput) typeInput.value = \"archive\";\n  if (categoryIdInput) categoryIdInput.value = categoryId;\n\n  toggleCategorySelect();\n  validateSlug();\n}\n\n/**\n * Update label and slug when category is selected\n */\nexport function updateLabelAndSlugFromCategory() {\n  const categorySelect = document.getElementById(\"category_id\");\n  const labelInput = document.getElementById(\"label\");\n  const slugInput = document.getElementById(\"slug\");\n\n  if (!categorySelect || !labelInput || !slugInput) return;\n\n  const selectedOption = categorySelect.options[categorySelect.selectedIndex];\n\n  if (selectedOption.value === \"\") {\n    // All categories\n    labelInput.value = \"Tous les articles\";\n    slugInput.value = \"posts\";\n  } else {\n    // Specific category - use category slug\n    const categoryName = selectedOption.getAttribute(\"data-name\");\n    const categorySlug = selectedOption.getAttribute(\"data-slug\");\n    labelInput.value = categoryName;\n    slugInput.value = categorySlug;\n  }\n\n  // Trigger validation\n  validateSlug();\n}\n\n// Auto-initialize when DOM is ready\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", initMenuPage);\n} else {\n  initMenuPage();\n}\n\n// Export functions to window for inline onclick handlers (temporary until we refactor to data attributes)\nwindow.fillForm = fillForm;\nwindow.toggleCategorySelect = toggleCategorySelect;\nwindow.fillFormForAllPosts = fillFormForAllPosts;\nwindow.fillFormForCategory = fillFormForCategory;\nwindow.updateLabelAndSlugFromCategory = updateLabelAndSlugFromCategory;\n","// Import the SCSS\nimport \"../scss/admin.scss\";\n\n// Import page-specific modules\nimport \"./pages/menu.js\";\n\n// Admin JavaScript\nconsole.log(\"Admin panel loaded\");\n\n// Example: CSRF token auto-insert\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const csrfToken = document.querySelector('meta[name=\"csrf-token\"]')?.content;\n\n  if (csrfToken) {\n    // Auto-add CSRF to all forms\n    document.querySelectorAll(\"form\").forEach((form) => {\n      if (!form.querySelector('input[name=\"_token\"]')) {\n        const input = document.createElement(\"input\");\n        input.type = \"hidden\";\n        input.name = \"_token\";\n        input.value = csrfToken;\n        form.appendChild(input);\n      }\n    });\n  }\n});\n"],"names":["RESERVED_SLUGS","usedMenuSlugs","initMenuPage","menuForm","slugsData","setupEventListeners","slugInput","typeInput","validateSlug","handleFormSubmit","fillForm","label","slug","type","labelInput","errorEl","warningEl","submitBtn","e","toggleCategorySelect","categoryGroup","postsSection","categoriesSection","categoryIdInput","fillFormForAllPosts","fillFormForCategory","name","categoryId","updateLabelAndSlugFromCategory","categorySelect","selectedOption","categoryName","categorySlug","csrfToken","_a","form","input"],"mappings":"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"}